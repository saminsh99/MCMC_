% ???? ???????? ????????
T=500; %????? ?????
%????? ????? ?? ??? ???? ????? ????? ?? ???? ?? ?????
x=1;
theta_0=-30;theta_inf=30; %???? ? ???
%???? ????? ?? ??? mcmc ??????? ???? ???? ?? ??? ????? ??????? ????

theta=zeros(1,T);%????? ?? ????? ??? ??? ?? ????? ?? ?? t  

rng('default')
theta(1)=unifrnd(theta_0,theta_inf); %??? ???? ?? ????? ?????
%???? ????? ????
t=1;
while t<T  % ???? ??????? 
    t=t+1;
    thetaprim=normrnd(theta(t-1),x);
    alpha=min(1,MCMC(thetaprim)/MCMC(theta(t-1)));
    u=rand;
    %??????
    if  u<alpha
        theta(t)=thetaprim;
    else
        theta(t)=theta(t-1); %??? ????? ?? ??? ????? ???
    end
end
%-------------------------------------------------------------------
% display histogram of samples

figure(1)
subplot(2,1,1);
histogram(theta,200);% ??? ?????? ?????????

nbins=200;
thetabins=linspace(theta_0,theta_inf,nbins); %????? ? ??? ??? ????? ? ???? ??????? ?? ?? ????? ????? ????? ????
counts=hist(theta,thetabins); % ?? ?????? ???? ????? ?? ????? ?? ?????
bar(thetabins,counts/sum(counts))
xlim([theta_0,theta_inf])
xlabel('\theta');
ylabel('p(\theta)');

%???? ????? ????
y=MCMC(thetabins);
hold on
plot(thetabins,y/sum(y),'g','linewidth',4);
hold off
%-------

subplot(2,1,2:2)
plot(theta,1:T,'k');
xlabel('\theta'); ylabel('t');    %???? x ?????           
xlim([theta_0,theta_inf]);
